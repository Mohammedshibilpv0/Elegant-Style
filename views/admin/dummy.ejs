
<%-include('../partials/user/adminheader.ejs')%>

<style>
 .product-card {
  border: 1px solid #ddd;
  padding: 10px;
  margin: 10px;
}

.image-cards {
  display: flex;
  justify-content: space-between;
  margin-top: 10px;
}

.image-card {
  border: 1px solid #ddd;
  padding: 5px;
  margin-right: 5px;
}

.image-card img {
  width: 100%;
  height: auto;
}

  </style>
    
<div id="main-wrapper" data-theme="light" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
data-sidebar-position="fixed" data-header-position="fixed" data-boxed-layout="full">
<!-- ============================================================== -->
<!-- Topbar header - style you can find in pages.scss -->
<!-- ============================================================== -->
<header class="topbar" data-navbarbg="skin6">
    <nav class="navbar top-navbar navbar-expand-lg">
        <div class="navbar-header" data-logobg="skin6">
            <!-- This is for the sidebar toggle which is visible on mobile only -->
            <a class="nav-toggler waves-effect waves-light d-block d-lg-none" href="javascript:void(0)"><i
                    class="ti-menu ti-close"></i></a>
            <!-- ============================================================== -->
            <!-- Logo -->
            <!-- ============================================================== -->
            <div class="navbar-brand">
                <!-- Logo icon -->
                <a href="home.ejs">
                    <img src="/admin/assets/images/freedashDark.svg" alt="" class="img-fluid">
                </a>
            </div>
            <!-- ============================================================== -->
            <!-- End Logo -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- Toggle which is visible on mobile only -->
            <!-- ============================================================== -->
            <a class="topbartoggler d-block d-lg-none waves-effect waves-light" href="javascript:void(0)"
                data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><i
                    class="ti-more"></i></a>
        </div>
        <!-- ============================================================== -->
        <!-- End Logo -->
        <!-- ============================================================== -->
        <div class="navbar-collapse collapse" id="navbarSupportedContent">
     
            <ul class="navbar-nav float-end">
                <!-- ============================================================== -->
                <!-- Search -->
                <!-- ============================================================== -->
                <!-- <li class="nav-item d-none d-md-block">
                    <a class="nav-link" href="javascript:void(0)">
                        <form>
                            <div class="customize-input">
                                <input class="form-control custom-shadow custom-radius border-0 bg-white"
                                    type="search" placeholder="Search" aria-label="Search">
                                <i class="form-control-icon" data-feather="search"></i>
                            </div>
                        </form>
                    </a>
                </li> -->

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="javascript:void(0)" data-bs-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">
                        <img src="/admin/assets/images/users/profile-pic.jpg" alt="user" class="rounded-circle"
                            width="40">
                        <span class="ms-2 d-none d-lg-inline-block"><span>Hello,</span> <span
                                class="text-dark"><%=admin%></span> <i data-feather="chevron-down"
                                class="svg-icon"></i></span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end dropdown-menu-right user-dd animated flipInY">
                        <a class="dropdown-item" href="javascript:void(0)"><i data-feather="user"
                                class="svg-icon me-2 ms-1"></i>
                            My Profile</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="/admin/logout"><i data-feather="power"
                                class="svg-icon me-2 ms-1"></i>
                            Logout</a>
                        <div class="dropdown-divider"></div>
                        
                    </div>
                </li>
                <!-- ============================================================== -->
                <!-- User profile and search -->
                <!-- ============================================================== -->
            </ul>
        </div>
    </nav>
</header>
<!-- ============================================================== -->
<!-- End Topbar header -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- Left Sidebar - style you can find in sidebar.scss  -->
<!-- ============================================================== -->
<aside class="left-sidebar" data-sidebarbg="skin6">
    <!-- Sidebar scroll-->
    <div class="scroll-sidebar" data-sidebarbg="skin6">
        <!-- Sidebar navigation-->
        <nav class="sidebar-nav">
            <ul id="sidebarnav">
                <li class="sidebar-item"> <a class="sidebar-link sidebar-link" href="/admin/"
                        aria-expanded="false"><i data-feather="home" class="feather-icon"></i><span
                            class="hide-menu">Dashboard</span></a></li>
                <li class="list-divider"></li>
                <li class="nav-small-cap"><span class="hide-menu">Users</span></li>

                <li class="sidebar-item"> <a class="sidebar-link" href="/admin/allusers"
                        aria-expanded="false"><i class="fa-regular fa-user"></i><span
                            class="hide-menu">All Users
                        </span></a>
                </li>

                <li class="list-divider"></li>


                <li class="nav-small-cap"><span class="hide-menu">Products</span></li>

                <li class="sidebar-item"> <a class="sidebar-link" href="/admin/products"
                    aria-expanded="false"><i class="fa-regular fa-user"></i><span
                        class="hide-menu">All Product  </span></a>
            </li>

            <li class="sidebar-item"> <a class="sidebar-link" href="/admin/addproducts"
                aria-expanded="false"><i class="fa-solid fa-plus"></i><span
                    class="hide-menu">Add Products</span></a>
             </li>

             <li class="sidebar-item"> <a class="sidebar-link" href="/admin/category"
                aria-expanded="false"><i class="fa-solid fa-list"></i><span
                    class="hide-menu">category</span></a>
             </li>


                <li class="list-divider"></li>
                <li class="nav-small-cap"><span class="hide-menu">Orders</span></li>

                <li class="sidebar-item"> <a class="sidebar-link sidebar-link" href="/admin/allorders"
                        aria-expanded="false"><i class="fa-solid fa-cart-shopping"></i><span
                            class="hide-menu">All Orders
                        </span></a>
                </li>
           

                
                <li class="list-divider"></li>
                <li class="nav-small-cap"><span class="hide-menu">Extra</span></li>
                
                <li class="sidebar-item"> <a class="sidebar-link sidebar-link" href="/admin/logout"
                        aria-expanded="false"><i data-feather="log-out" class="feather-icon"></i><span
                            class="hide-menu">Logout</span></a></li>
            </ul>
        </nav>
        <!-- End Sidebar navigation -->
    </div>
    <!-- End Sidebar scroll-->
</aside>

<div class="page-wrapper bg-dark" style="min-height: 775px;">
    <div class="container mt-5">
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="card">
            <div class="card-body">

<form action="/admin/submitedit/<%=products.id%>" method="post"  class="bg-white">


    <div class="form-group row">
        <label for="productName" class="col-sm-3 col-form-label" >Product Name</label>
        <div class="col-sm-9">
          <input type="text" class="form-control" id="productName" name="name" placeholder="Product Name" value="<%=products.Name%>" required>
          <small id="nameError" class="text-danger"></small>
        </div>
      </div>

      <div class="form-group row">
        <label for="productPrice" class="col-sm-3 col-form-label">Product Price</label>
        <div class="col-sm-9">
          <input type="number" class="form-control" id="productPrice" value="<%=products.Price%>" name="price" placeholder="Product Price" required>
          <small id="priceError" class="text-danger"></small>
        </div>
      </div>

     

  <div class="form-group row">
      <label for="productDescription" class="col-sm-3 col-form-label">Product Description</label>
      <div class="col-sm-9">
          <input class="form-control" id="productDescription" name="description" value="<%=products.Name%>" placeholder="Product Description" required>
          <small id="descriptionError" class="text-danger"></small>
      </div>
  </div>

  <div class="form-group row">
      <label for="productCategory" class="col-sm-3 col-form-label">Category</label>
      <div class="col-sm-9">
        <select class="form-control" id="productCategory" name="category" required>
            <% category.forEach(category => { %>
              <option value="<%= category._id %>" <%= (category._id.toString() === products.Category.toString()) ? 'selected' : '' %>><%= category.Name %></option>
            <% }); %>
          </select>
          
          <small id="categoryError" class="text-danger"></small>
      </div>
  </div>
  <div class="form-group row">
      <label for="productQuantity" class="col-sm-3 col-form-label">Quantity</label>
      <div class="col-sm-9">
          <input type="number" class="form-control" id="productQuantity" name="quantity" placeholder="Quantity" required>
          <small id="quantityError" class="text-danger"></small>
      </div>
  </div>




      <div class="form-group row">
          <label for="productDate" class="col-sm-3 col-form-label">Images(upto-4)</label>
          <input type="file" class="form-control" id="productimages" name="images" multiple="multiple" >
          <small id="imagesError" class="text-danger"></small>

            <!-- Image preview container -->
            <div id="image-preview-container" class="mt-3"></div>
          </div>
        </div>

      <button type="submit" class="btn btn-primary mr-2"">Submit</button>

   <!-- Display product images on small cards -->
   <div class="form-group row">
  <label for="productDate" class="col-sm-3 col-form-label">Images</label>
  <div class="col-sm-9">
    <% products.Images.forEach((image, index) => { %>
      <div class="card mb-3">
        <img src="/uploads/<%= image %>" class="card-img-top" alt="Product Image">
        <div class="card-body">
          <!-- Additional information or actions can be added here -->
          <p class="card-text">Image <%= index + 1 %></p>
        </div>
      </div>
    <% }); %>
    <small id="imagesError" class="text-danger"></small>
  </div>
</div>

  
</div>



</form>



</div>
</div>
      </div>
    </div>
</div>
</div>






<script>

  // Set the default value using JavaScript
  document.getElementById('productPrice').value = "<%= products.Price %>";
  document.getElementById('productQuantity').value = "<%= products.Quantity %>";

  function confirmDelete(productId, imageIndex) {
    if (confirm('Are you sure you want to delete this image?')) {
      // Perform AJAX request to delete the image
      fetch(`/admin/deleteimage/${productId}/${imageIndex}`, {
        method: 'DELETE',
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          // Remove the deleted image from the UI
          const imageCard = document.querySelector(`.image-cards .image-card[data-index="${imageIndex}"]`);
          if (imageCard) {
            imageCard.remove();
          }
        } else {
          alert('Failed to delete image.');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while deleting the image.');
      });
    }
  }

</script>
<%-include('../partials/user/adminfooter.ejs')%>